# Руководство по системе шаблонов услуг

## Обзор системы

Реализована полная система управления услугами через шаблоны с тремя уровнями:

**Администратор → Бизнес-пользователь → Обычный пользователь**

---

## Архитектура

### 1. Типы данных (`src/types/index.ts`)

#### `FormFieldType`
Поддерживаемые типы полей:
- `text` - Однострочный текст
- `textarea` - Многострочный текст
- `number` - Число
- `select` - Выбор из списка
- `multiselect` - Множественный выбор
- `date` - Дата
- `time` - Время
- `datetime` - Дата и время
- `price` - Цена
- `duration` - Длительность
- `phone` - Телефон
- `address` - Адрес
- `images` - Изображения
- `checkbox` - Чекбокс
- `radio` - Радио-кнопки
- `programs` - Программы услуг (с ценами)

#### `ServiceFormField`
Описание поля формы:
```typescript
{
  id: string;
  type: FormFieldType;
  label: string;
  placeholder?: string;
  required: boolean;
  options?: FormFieldOption[];
  min?: number;
  max?: number;
  step?: number;
  defaultValue?: any;
  helpText?: string;
}
```

#### `ServiceTemplate`
Шаблон категории услуг:
```typescript
{
  id: string;
  categoryId: string;  // Связь с категорией
  fields: ServiceFormField[];
  createdAt: string;
  updatedAt: string;
}
```

---

## Реализованные шаблоны (`src/data/serviceTemplates.ts`)

### 1. Массаж (categoryId: '1')
**Поля:**
- Название услуги
- Описание
- Фотографии салона
- Программы массажа (с ценами)
- Длительность сеанса
- Часы работы
- Адрес салона
- Телефон для записи

### 2. Реальная встреча (categoryId: '2')
**Поля:**
- Имя
- Возраст
- О себе
- Фото
- Типы встреч (Выезд/Апартаменты)
- Программы встречи
- Город
- Языки
- Телефон

### 3. Стриптиз (categoryId: '3')
**Поля:**
- Имя
- Возраст
- Пол
- О себе
- Портфолио (фото)
- Специализации
- Цена за час
- Город
- Опыт работы (лет)
- Доступность по дням
- Телефон

### 4. Виртуальный секс (categoryId: '4')
**Поля:**
- Имя
- Возраст
- О себе
- Фото
- Типы услуг (Аудио/Видео/Чат)
- Специализации
- Цена за минуту
- Минимальная длительность
- Максимальная длительность
- Языки
- Город (необязательно)

### 5. Вечерний ужин (categoryId: '5')
**Поля:**
- Имя
- Возраст
- О себе
- Фото
- Название ресторана
- Адрес ресторана
- Доступные дни
- Время ужина
- Цена за вечер
- Языки
- Телефон

### 6. Заграница (categoryId: '6')
**Поля:**
- Имя
- Возраст
- О себе
- Фото из путешествий
- Планируемые направления
- Даты поездок
- Цена за день
- Что включено (проживание, перелеты, питание и т.д.)
- Языки
- Телефон

### 7. Эскорт на мероприятиях (categoryId: '7')
**Поля:**
- Имя
- Возраст
- О себе
- Фото в вечерних нарядах
- Типы мероприятий (деловые, светские, банкеты и т.д.)
- Цена за мероприятие
- Город
- Образование
- Языки
- Телефон

---

## Компоненты

### 1. AdminServicesManager (`src/components/admin/AdminServicesManager.tsx`)

**Функционал:**
- Управление категориями услуг (создание, редактирование, удаление)
- Просмотр готовых шаблонов форм
- Два таба: "Категории услуг" и "Шаблоны форм"

**Особенности:**
- Показывает все поля каждого шаблона с их типами
- Интерактивное раскрытие деталей шаблона по клику
- Визуальная индикация типов полей и обязательности

### 2. DynamicServiceForm (`src/components/business/DynamicServiceForm.tsx`)

**Функционал:**
- Универсальная динамическая форма на основе шаблона
- Автоматическая валидация обязательных полей
- Поддержка всех 16 типов полей
- Управление программами услуг
- Загрузка изображений

**Особенности:**
- Полностью типизирована с TypeScript
- Интеграция с react-hook-form
- Toast уведомления об ошибках
- Автозаполнение defaultValue из шаблона

### 3. BusinessDashboard (`src/components/pages/business/BusinessDashboard.tsx`)

**Обновления:**
- Двухшаговый процесс создания объявления:
  1. Выбор категории
  2. Заполнение динамической формы
- Автоматический выбор шаблона по категории
- Сохранение formData в BusinessService
- Отображение объявлений с данными из шаблонов

---

## Как это работает

### Для администратора:

1. Переход в админ-панель → вкладка "Услуги"
2. Таб "Категории услуг" - управление категориями
3. Таб "Шаблоны форм" - просмотр готовых шаблонов с полной логикой
4. При добавлении категории автоматически привязывается шаблон по ID

### Для бизнес-пользователя:

1. Вход в бизнес-кабинет → "Объявления"
2. Нажать "Создать объявление"
3. Выбрать категорию из списка (например, "Массаж")
4. Автоматически загружается шаблон с полями для этой категории
5. Заполнить все обязательные поля
6. Сохранить объявление

### Для обычного пользователя:

1. Просмотр каталога → вкладка "Бизнес услуги"
2. Видит карточки активных объявлений
3. Все данные отображаются согласно шаблону категории
4. Может связаться с исполнителем

---

## Примеры использования

### Добавление новой категории с готовым шаблоном

1. Администратор добавляет категорию "Массаж"
2. В `serviceTemplates.ts` уже есть готовый шаблон для массажа
3. Бизнес-пользователь выбирает категорию "Массаж"
4. Автоматически появляется форма с полями:
   - Название услуги
   - Описание
   - Фотографии
   - Программы (Классический, Расслабляющий и т.д.)
   - Длительность сеанса
   - Адрес салона
   - Телефон

### Создание объявления стриптиза

```typescript
// Бизнес-пользователь заполняет форму:
{
  title: "Кристина",
  age: 25,
  gender: "female",
  description: "Профессиональный pole dance...",
  images: ["url1", "url2"],
  specializations: ["pole", "classic", "erotic"],
  pricePerHour: 7000,
  city: "moscow",
  experience: 5,
  availability: ["fri", "sat", "sun"],
  phone: "+7 (999) 123-45-67"
}
```

Все данные сохраняются в `BusinessService.formData` и используются для отображения в каталоге.

---

## Преимущества системы

1. **Централизованное управление** - администратор контролирует структуру всех форм
2. **Единообразие данных** - все объявления одной категории имеют одинаковую структуру
3. **Гибкость** - легко добавлять новые поля или изменять существующие
4. **Валидация** - автоматическая проверка обязательных полей
5. **Масштабируемость** - можно добавлять неограниченное количество категорий и шаблонов
6. **Типобезопасность** - полная поддержка TypeScript

---

## Связь ID категорий

Шаблоны связаны с категориями через `categoryId`:

| Категория              | ID  | Файл шаблона            |
|------------------------|-----|-------------------------|
| Массаж                 | 1   | massageTemplate         |
| Реальная встреча       | 2   | realMeetingTemplate     |
| Стриптиз               | 3   | stripteaseTemplate      |
| Виртуальный секс       | 4   | virtualSexTemplate      |
| Вечерний ужин          | 5   | dinnerDateTemplate      |
| Заграница              | 6   | abroadTravelTemplate    |
| Эскорт на мероприятиях | 7   | escortEventsTemplate    |

---

## Расширение системы

Для добавления нового шаблона:

1. Создать объект `ServiceTemplate` в `serviceTemplates.ts`
2. Указать правильный `categoryId`
3. Определить массив `fields` с необходимыми полями
4. Добавить в экспорт `serviceTemplates`
5. Готово! Шаблон автоматически подхватится системой

---

## Технологии

- **React** - UI компоненты
- **TypeScript** - типобезопасность
- **Shadcn UI** - компоненты интерфейса
- **Context API** - управление состоянием
- **React Hook Form** - работа с формами (в DynamicServiceForm)

---

Система полностью готова к использованию!
